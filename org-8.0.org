#+TITLE: Upgrading to Org 8.0 or the current master branch
#+AUTHOR: Bastien Guerry
#+EMAIL: bzg @ gnu DOT org
#+LANGUAGE:  en

* Using the current master branch

#+INDEX: 8.0
#+INDEX: exporter
#+INDEX: migrating

As of [[http://orgmode.org/cgit.cgi/org-mode.git/commit/?id%3D1cac3127c2f810e83fcc1203f1dd2b15250a687e][commit 1cac3127c]], the master branch of Org's git repository uses the
new exporter by default.  If you use the master branch, you need to update
your configuration and change some syntactic elements of your Org files.

If the instructions below do not help solving your problem, please ask any
question on the mailing list, it will help us moving forward with
documenting everything for Org 8.0.

* Files moved to =contrib/=

These files have been moved to the =contrib/= directory.

If you were using them, you need to add the =contrib/= directory
of the Org distribution to the Emacs =load-path=.

- =org-mew.el=
- =org-wl.el=
- =org-w3m.el=
- =org-vm.el=
- =org-colview-xemacs.el=
- =ox-freemind.el= (was org-freemind.el)

* Updating global export configuration options

Global export options start with the =org-export-*= prefix, most of them
are in the =ox.el= file.

For options starting with e.g. =org-export-html-*=, see the section below.

For generic export options, most of them should not need any change.  If
you find that a generic option is useless or broken or badly documented in
the manual, please report it to the list.

* Updating backend-specific configuration options

Backend-specific options are defined like this:

- =org-html-*= for =HTML= and live in =ox-html.el=
- =org-latex-*= for =LaTeX= and live in =ox-latex.el=
- Etc.  

There is a new variable =org-export-backends= which controls what backends
are loaded when you lauch Org.  By default, the =ASCII=, =HTML= and =LaTeX=
are loaded, with some others.

*Updating*: In your =.emacs= you need to rename =org-export-html-*= options
to =org-html-*= and do the same for other backends.

** Renaming/deleting of some HTML options

| Org 7.9.3f (maint)                     | Master (8.0)                           |
|----------------------------------------+----------------------------------------|
| org-export-html-style                  | org-html-head                          |
| org-export-html-style-extra            | org-html-head-extra                    |
| org-export-html-style-default          | org-html-head-include-default-style    |
| org-export-html-style-include-scripts  | org-html-head-include-scripts          |
| org-export-htmlized-org-css-url        | org-org-htmlized-css-url (in ox-org.el |
|----------------------------------------+----------------------------------------|
| org-export-html-headline-anchor-format | Deleted                                |
| org-export-html-date-format-string     | Deteted                                |
| org-export-html-content-div            | Deleted                                |
| org-export-html-html-helper-timestamp  | Deleted                                |

* Updating =org-publish-project-alist=

The publishing functions are not loaded until the corresponding backend has
been loaded.  You need to update =org-publish-project-alist= and to use the
function from the new publishing engine -- here is correspondance table:

| Old publishing engine    | New publishing engine      |
|--------------------------+----------------------------|
| org-publish-org-to-html  | org-html-publish-to-html   |
| org-publish-org-to-org   | org-org-publish-to-org     |
| org-publish-org-to-latex | org-latex-publish-to-latex |
| ...                      | ...                        |

If something does not work, please report it on the mailing list.

* Other important changes

1. =#+STYLE:= -> =#+HTML_HEAD:=

2. =#+SETUPFILE: myfile= -> =#+INCLUDE: "myfile"=

   Quotes are required and =#+INCLUDE= works a little differently
   than #+setupfile: by default, it makes sure that every headline in the
   included file will be a child of the headline containing the include
   keyword.  You can overwrite this behaviour with =:minlevel= num
   parameter.

1. Attribute lines now take plists:

   : #+attr_latex :width "5cm"
   : #+attr_beamer :options "width=5cm"

2. Beamer backend now interprets nested headline levels as blocks instead
   of lists.  For some preliminary guidance you can look at [[file:exporters/beamer/ox-beamer.org][this page]].

* Using Org 7.9.3f or earlier versions of Org

1. If you had already been using the new exporter from contrib, you should
   remove the following lines from your local.mk:
   : ORG_ADD_CONTRIB = org-e-*
   followed by a =make clean=, before you do =git pull=.

2. Export engine renamed: org-export → ox

3. Backend requires renamed: org-e-* → ox-*

4. All backend specific variables and functions renamed:
   - org-export-* → org-* (e.g. org-html-xml-declaration, ..)
   - org-e-* → org-* (e.g. org-latex-classes, org-ascii-bullets, ..)

5. Generic export variables retain the name org-export-*
   (e.g. org-export-dispatch-use-expert-ui,
   org-export-filter-headline-functions, ..)

6. org-latex-to-pdf-process has been renamed to org-latex-pdf-process

7. This is a guess, export snippets and backend symbols renamed:
   - e-<backend> → <backend>

Please also read [[http://mid.gmane.org/876229nrxf.fsf@gmail.com][Nicolas' announcement]] about the merge.

