<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
               "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
lang="en" xml:lang="en">
<head>
<title>Genetic drift</title>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
<meta name="generator" content="Org-mode"/>
<meta name="generated" content="2010-02-10 00:12:27 EST"/>
<meta name="author" content="Dan Davison"/>
<meta name="description" content=""/>
<meta name="keywords" content=""/>
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  html { font-family: Times, serif; font-size: 12pt; }
  .title  { text-align: center; }
  .todo   { color: red; }
  .done   { color: green; }
  .tag    { background-color: #add8e6; font-weight:normal }
  .target { }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  p.verse { margin-left: 3% }
  pre {
	border: 1pt solid #AEBDCC;
	background-color: #F3F5F7;
	padding: 5pt;
	font-family: courier, monospace;
        font-size: 90%;
        overflow:auto;
  }
  table { border-collapse: collapse; }
  td, th { vertical-align: top; }
  dt { font-weight: bold; }
  div.figure { padding: 0.5em; }
  div.figure p { text-align: center; }
  .linenr { font-size:smaller }
  .code-highlighted {background-color:#ffff00;}
  .org-info-js_info-navigation { border-style:none; }
  #org-info-js_console-label { font-size:10px; font-weight:bold;
                               white-space:nowrap; }
  .org-info-js_search-highlight {background-color:#ffff00; color:#000000;
                                 font-weight:bold; }
  /*]]>*/-->
</style><style type="text/css">
pre {
    border: 1pt solid #AEBDCC;
    background-color: #232323;
    color: #E6E1DC;
    padding: 5pt;
    font-family: courier, monospace;
    font-size: 90%;
    overflow:auto;
}
</style>
<script type="text/javascript">
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">

<h1 class="title">Genetic drift</h1>


<div id="outline-container-1" class="outline-2">
<h2 id="sec-1">A simple model of evolution </h2>
<div class="outline-text-2" id="text-1">

<p>Evolution is the result of changes in the genetic composition of
populations over time. One of the simplest models of evolution is as
follows. There is a population of N individuals, among which there
are two genetic types: red and blue<sup><a class="footref" name="fnr.1" href="#fn.1">1</a></sup>. Here is the initial
generation of the population (N=10).
</p>


<p>
<img src="drift-1-gen.png"  alt="drift-1-gen.png" />
</p>
<p>
There is no mutation, no selection and no sex; the next generation
is made up by randomly choosing 10 individuals from the previous
generation<sup><a class="footref" name="fnr.2" href="#fn.2">2</a></sup>. A single individual can be chosen more than once,
or not at all; the number of times an individual is chosen
corresponds to the number of progeny it has in the next
generation. Even without mutation or natural selection the
proportions of red and blue types will change, because different
individuals will have different numbers of offspring, by chance.
</p>
<p>
So the first two generations might look like this.
</p>


<p>
<img src="drift-2-gen.png"  alt="drift-2-gen.png" />
</p>

<p>
This is a form of evolution called "genetic drift". It is inevitable,
although if the population is very large it will have less effect.
</p>
<p>
Let X<sub>t</sub> be the number of red individuals in generation t, and let p<sub>t</sub>
be the proportion of red individuals. So X<sub>1</sub> is 6 and p<sub>1</sub> is 0.6. To
choose the number of red individuals in generation 2 we make 10
choices, each time having probability 6/10 of getting a red
individual. So X<sub>2</sub> is a <i>binomial</i> random variable, with 10 trials and
success probability 0.6. In general, the random process is described
by the following transition probabilities.
</p>


<p>
<img src="transprob.png"  alt="transprob.png" />
</p>
<p>
We can simulate the evolution over many generations in R. This code
simulates the change in frequency in a single population over 100
generations. We'll make the population larger (N=1000) but still
start off with 60% red individuals.
</p>



<pre class="src src-org-babel-lob"><span style="color: #afeeee; font-weight: bold;">function</span> simpledrift(X1=600, N=1000, ngens=100):
</pre>



<pre class="src src-R">p <span style="color: #98fb98;">&lt;-</span> numeric(ngens)
p[1] <span style="color: #98fb98;">&lt;-</span> X1/N
<span style="color: #afeeee; font-weight: bold;">for</span>(g <span style="color: #afeeee; font-weight: bold;">in</span> 2:ngens)
    p[g] <span style="color: #98fb98;">&lt;-</span> rbinom(1, size=N, prob=p[g-1]) / N
plot(p, type=<span style="color: #87cefa;">"l"</span>, ylim=c(0,1), xlab=<span style="color: #87cefa;">"Generation"</span>, ylab=<span style="color: #87cefa;">"Proportion red"</span>)
</pre>




<p>
<img src="simpledrift.png"  alt="simpledrift.png" />
</p>
<p>
But how variable is this process? To answer this we need to repeat
the simulation many times (i.e. simulate many identical but
independent populations). We could do that as follows
</p>



<pre class="src src-R"><span style="color: #7fffd4; font-weight: bold;">drift.slow</span> <span style="color: #98fb98;">&lt;-</span> <span style="color: #afeeee; font-weight: bold;">function</span>(N, X1, ngens, nreps) {
    p <span style="color: #98fb98;">&lt;-</span> matrix(<span style="color: #87ceeb; font-weight: bold;">NA</span>, nrow=ngens, ncol=nreps)
    p[1,] <span style="color: #98fb98;">&lt;-</span> X1/N
    <span style="color: #afeeee; font-weight: bold;">for</span>(rep <span style="color: #afeeee; font-weight: bold;">in</span> 1:nreps) {
        <span style="color: #afeeee; font-weight: bold;">for</span>(g <span style="color: #afeeee; font-weight: bold;">in</span> 2:ngens)
            p[g,rep] <span style="color: #98fb98;">&lt;-</span> rbinom(1, size=N, prob=p[g-1,rep]) / N
    }
    p
}
</pre>




<p>
But this is not a good implementation. One should make use of
"vectorisation", which makes the simulation much more efficient when
there are many replicates<sup><a class="footref" name="fnr.3" href="#fn.3">3</a></sup>. Note the way that rbinom simulates
all replicates at once, but still one generation at a time.
</p>



<pre class="src src-R"><span style="color: #7fffd4; font-weight: bold;">drift.faster</span> <span style="color: #98fb98;">&lt;-</span> <span style="color: #afeeee; font-weight: bold;">function</span>(N, X1, ngens, nreps) {
    p <span style="color: #98fb98;">&lt;-</span> matrix(<span style="color: #87ceeb; font-weight: bold;">NA</span>, nrow=ngens, ncol=nreps)
    p[1,] <span style="color: #98fb98;">&lt;-</span> X1/N
    <span style="color: #afeeee; font-weight: bold;">for</span>(gen <span style="color: #afeeee; font-weight: bold;">in</span> 2:ngens)
        p[gen,] <span style="color: #98fb98;">&lt;-</span> rbinom(n=nreps, size=N, prob=p[gen-1,]) / N
    p
}
</pre>




<p>
To run the simulation:
</p>



<pre class="src src-org-babel-lob"><span style="color: #afeeee; font-weight: bold;">function</span> drift(nreps=10, N=1000, X1=600, ngens=100):
</pre>



<pre class="src src-R">p <span style="color: #98fb98;">&lt;-</span> drift.faster(N, X1, ngens, nreps)
matplot(p, type=<span style="color: #87cefa;">"l"</span>, ylim=c(0,1), lty=1)
</pre>




<p>
<img src="repdrift.png"  alt="repdrift.png" />
And let's quickly see how much of a speed difference the vectorisation
makes.
</p>



<pre class="src src-org-babel-lob"><span style="color: #afeeee; font-weight: bold;">function</span> compare-times(nreps=1000, N=1000, X1=600, ngens=100):
</pre>



<pre class="src src-R">functions <span style="color: #98fb98;">&lt;-</span> c(drift.slow=drift.slow, drift.faster=drift.faster)
times <span style="color: #98fb98;">&lt;-</span> sapply(functions, <span style="color: #afeeee; font-weight: bold;">function</span>(f) as.numeric(system.time(f(N, X1, ngens, nreps))[1]))
print(times)
cat(sprintf(<span style="color: #87cefa;">"\nFactor speed-up = %.1f\n"</span>, times[1] / times[2]))
</pre>




<pre class="example">
  drift.slow drift.faster 
       6.064        0.204

Factor speed-up = 29.7
</pre>











</div>
</div>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">
<p class="footnote"><sup><a class="footnum" name="fn.1" href="#fnr.1">1</a></sup> Every individual is chacterised by a single type; no sex,
recombination, mutation, selection, etc.
</p>
<p class="footnote"><sup><a class="footnum" name="fn.2" href="#fnr.2">2</a></sup> All members of the previous generation die as the next
generation is formed.
</p>
<p class="footnote"><sup><a class="footnum" name="fn.3" href="#fnr.3">3</a></sup> Note that we can't vectorise the entire simulation because
drift is a Markov process.
</p>
<p class="footnote"><sup><a class="footnum" name="fn.1" href="#fnr.1">1</a></sup> FOOTNOTE DEFINITION NOT FOUND: fn:1
</p>
<p class="footnote"><sup><a class="footnum" name="fn.2" href="#fnr.2">2</a></sup> FOOTNOTE DEFINITION NOT FOUND: fn:2
</p>
<p class="footnote"><sup><a class="footnum" name="fn.3" href="#fnr.3">3</a></sup> FOOTNOTE DEFINITION NOT FOUND: fn:3
</p>
</div>
</div>
<div id="postamble">
<p class="date"> Date: 2010-02-10 00:12:27 EST</p>
<p class="creator">HTML generated by org-mode 6.34trans in emacs 23</p>
</div>
</div>
</body>
</html>
